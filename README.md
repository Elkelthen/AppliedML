# Elkelthen.github.io

```
# -*- coding: utf-8 -*-
"""Midterm_Project.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1oQiredLPLY42iKUQuNFj3ZN92cq6upiJ
"""

# Imports

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn import linear_model
from sklearn.metrics import mean_squared_error
from sklearn.preprocessing import StandardScaler, PolynomialFeatures
from sklearn.model_selection import KFold
from sklearn.ensemble import RandomForestRegressor

# Problem 1

df = pd.read_csv('weatherHistory.csv')
df.size

# Problem 1 Corrected

df = pd.read_csv('weatherHistory.csv')
df.shape # Corrected from .size to .shape
len(df)  # Another way to do it

# Problem 2
df = pd.read_csv('weatherHistory.csv')
df

# Problem 3

df = pd.read_csv('weatherHistory.csv')

temp = np.array(df[['Temperature (C)']])
temp.reshape(-1,1)

humidity = np.array(df[['Humidity']])

lm = linear_model.LinearRegression()
model = lm.fit(temp, humidity)

humidity_hat = lm.predict(temp)

rms = mean_squared_error(humidity, humidity_hat, squared=False)

rms

# Problem 4

df = pd.read_csv('weatherHistory.csv')
scale = StandardScaler()
model = linear_model.Ridge(alpha=0.1)
PE = []
PE_train = []

feature_temp = pd.DataFrame(df[['Temperature (C)']])
target_humidity = pd.DataFrame(df[['Humidity']])

feature_temp_scaled = scale.fit_transform(feature_temp)
target_humidity_scaled = scale.fit_transform(target_humidity)

kf = KFold(n_splits=20, random_state=1234,shuffle=True)

for train_index, test_index in kf.split(feature_temp_scaled):
    X_train = feature_temp_scaled[train_index]

    y_train = target_humidity_scaled[train_index]

    X_test = feature_temp_scaled[test_index]

    y_test = target_humidity_scaled[test_index]

    model.fit(X_train, y_train)

    y_pred = model.predict(X_test)
    y_pred_train = model.predict(X_train)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 4 Corrected

df = pd.read_csv('weatherHistory.csv')
scale = StandardScaler()
model = linear_model.Ridge(alpha=0.1)
PE = []
PE_train = []

feature_temp = pd.DataFrame(df[['Temperature (C)']])
target_humidity = pd.DataFrame(df[['Humidity']])

feature_temp_scaled = scale.fit_transform(feature_temp)

kf = KFold(n_splits=20, random_state=1234,shuffle=True)

for train_index, test_index in kf.split(feature_temp_scaled):
    X_train = feature_temp_scaled[train_index]

    y_train = target_humidity.values[train_index]

    X_test = feature_temp_scaled[test_index]

    y_test = target_humidity.values[test_index]

    model.fit(X_train, y_train)

    y_pred = model.predict(X_test)
    y_pred_train = model.predict(X_train)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 5

df = pd.read_csv('weatherHistory.csv')

feature_temp = pd.DataFrame(df[['Apparent Temperature (C)']])
target_humidity = pd.DataFrame(df[['Humidity']])
target_humidity_scaled = scale.fit_transform(target_humidity)
scale = StandardScaler()
kf = KFold(n_splits=10, random_state=1693,shuffle=True)
RF_reg = RandomForestRegressor(n_estimators=100,max_depth=50)
PE = []
PE_train = []

for train_index, test_index in kf.split(feature_temp):
    X_train = feature_temp.values[train_index]
    X_train_scaled = scale.fit_transform(X_train)

    y_train = target_humidity_scaled[train_index]

    X_test = feature_temp.values[test_index]
    X_test_scaled = scale.transform(X_test)

    y_test = target_humidity_scaled[test_index]

    RF_reg.fit(X_train,y_train.ravel())

    y_pred = RF_reg.predict(X_test_scaled)
    y_pred_train = RF_reg.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 5 Corrected

df = pd.read_csv('weatherHistory.csv')

feature_temp = pd.DataFrame(df[['Apparent Temperature (C)']])
target_humidity = pd.DataFrame(df[['Humidity']])
scale = StandardScaler()
kf = KFold(n_splits=10, random_state=1693,shuffle=True)
RF_reg = RandomForestRegressor(n_estimators=100,max_depth=50)
PE = []
PE_train = []

for train_index, test_index in kf.split(feature_temp):
    X_train = feature_temp.values[train_index]
    X_train_scaled = scale.fit_transform(X_train)

    y_train = target_humidity.values[train_index]

    X_test = feature_temp.values[test_index]
    X_test_scaled = scale.transform(X_test)

    y_test = target_humidity.values[test_index]

    RF_reg.fit(X_train,y_train.ravel())

    y_pred = RF_reg.predict(X_test_scaled)
    y_pred_train = RF_reg.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 6

df = pd.read_csv('weatherHistory.csv')
PE = []
PE_train = []
model = linear_model.LinearRegression()
scale = StandardScaler()

feature_temp = pd.DataFrame(df[['Apparent Temperature (C)']])
target_humidity = pd.DataFrame(df[['Humidity']])
target_humidity_scaled = scale.fit_transform(target_humidity)

kf = KFold(n_splits=10, random_state=1693,shuffle=True)

polynomial_features= PolynomialFeatures(degree=6)

for train_index, test_index in kf.split(feature_temp):
    X_train = feature_temp.values[train_index]
    X_train_scaled = polynomial_features.fit_transform(np.array(X_train))

    y_train = target_humidity_scaled[train_index]

    X_test = feature_temp.values[test_index]
    X_test_scaled = polynomial_features.fit_transform(np.array(X_test))

    y_test = target_humidity_scaled[test_index]

    model.fit(X_train_scaled,y_train)

    y_pred = model.predict(X_test_scaled)
    y_pred_train = model.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 6 Corrected

df = pd.read_csv('weatherHistory.csv')
PE = []
PE_train = []
model = linear_model.LinearRegression()
scale = StandardScaler()

feature_temp = pd.DataFrame(df[['Apparent Temperature (C)']])
target_humidity = pd.DataFrame(df[['Humidity']])

kf = KFold(n_splits=10, random_state=1693,shuffle=True)

polynomial_features= PolynomialFeatures(degree=6)

for train_index, test_index in kf.split(feature_temp):
    X_train = feature_temp.values[train_index]
    X_train_scaled = polynomial_features.fit_transform(np.array(X_train))

    y_train = target_humidity.values[train_index]

    X_test = feature_temp.values[test_index]
    X_test_scaled = polynomial_features.fit_transform(np.array(X_test))

    y_test = target_humidity.values[test_index]

    model.fit(X_train_scaled,y_train)

    y_pred = model.predict(X_test_scaled)
    y_pred_train = model.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 7

df = pd.read_csv('weatherHistory.csv')
scale = StandardScaler()
model = linear_model.Ridge(alpha=0.2)
PE = []
PE_train = []

feature_temp = pd.DataFrame(df[['Temperature (C)']])
target_humidity = pd.DataFrame(df[['Humidity']])

target_humidity_scaled = scale.fit_transform(target_humidity)

kf = KFold(n_splits=10, random_state=1234,shuffle=True)

for train_index, test_index in kf.split(feature_temp):
    X_train = feature_temp.values[train_index]
    X_train_scaled = scale.fit_transform(X_train)

    y_train = target_humidity_scaled[train_index]

    X_test = feature_temp.values[test_index]
    X_test_scaled = scale.transform(X_test)

    y_test = target_humidity_scaled[test_index]

    model.fit(X_train_scaled, y_train)

    y_pred = model.predict(X_test_scaled)
    y_pred_train = model.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 7 Corrected

df = pd.read_csv('weatherHistory.csv')
scale = StandardScaler()
model = linear_model.Ridge(alpha=0.2)
PE = []
PE_train = []

feature_temp = pd.DataFrame(df[['Temperature (C)']])
target_humidity = pd.DataFrame(df[['Humidity']])

kf = KFold(n_splits=10, random_state=1234,shuffle=True)

for train_index, test_index in kf.split(feature_temp):
    X_train = feature_temp.values[train_index]
    X_train_scaled = scale.fit_transform(X_train)

    y_train = target_humidity.values[train_index]

    X_test = feature_temp.values[test_index]
    X_test_scaled = scale.transform(X_test)

    y_test = target_humidity.values[test_index]

    model.fit(X_train_scaled, y_train)

    y_pred = model.predict(X_test_scaled)
    y_pred_train = model.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 8

df = pd.read_csv('weatherHistory.csv')
PE = []
PE_train = []
model = linear_model.LinearRegression()
scale = StandardScaler()
 
feature_multiple = df[['Humidity','Wind Speed (km/h)','Pressure (millibars)','Wind Bearing (degrees)']]

target_temp = pd.DataFrame(df[['Temperature (C)']])

target_temp_scaled = scale.fit_transform(target_temp)

kf = KFold(n_splits=10, random_state=1234,shuffle=True)

polynomial_features= PolynomialFeatures(degree=6)

for train_index, test_index in kf.split(feature_multiple):
    X_train = feature_multiple.values[train_index]
    X_train_scaled = polynomial_features.fit_transform(np.array(X_train))

    y_train = target_temp_scaled[train_index]

    X_test = feature_multiple.values[test_index]
    X_test_scaled = polynomial_features.fit_transform(np.array(X_test))

    y_test = target_temp_scaled[test_index]

    model.fit(X_train_scaled,y_train)

    y_pred = model.predict(X_test_scaled)
    y_pred_train = model.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 8 Corrected
# Still slightly off. Expected 6.0234, Actual 6.1192

df = pd.read_csv('weatherHistory.csv')
PE = []
PE_train = []
model = linear_model.LinearRegression()
scale = StandardScaler()
 
feature_multiple = df[['Humidity','Wind Speed (km/h)','Pressure (millibars)','Wind Bearing (degrees)']]

target_temp = pd.DataFrame(df[['Temperature (C)']])

kf = KFold(n_splits=10, random_state=1234,shuffle=True)

polynomial_features= PolynomialFeatures(degree=6)

for train_index, test_index in kf.split(feature_multiple):
    X_train = feature_multiple.values[train_index]
    X_train_scaled = polynomial_features.fit_transform(np.array(X_train))

    y_train = target_temp.values[train_index]

    X_test = feature_multiple.values[test_index]
    X_test_scaled = polynomial_features.fit_transform(np.array(X_test))

    y_test = target_temp.values[test_index]

    model.fit(X_train_scaled,y_train)

    y_pred = model.predict(X_test_scaled)
    y_pred_train = model.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 9

df = pd.read_csv('weatherHistory.csv')
PE = []
PE_train = []
RF_reg = RandomForestRegressor(n_estimators=100,max_depth=50)
scale = StandardScaler()
 
feature_multiple = df[['Humidity','Wind Speed (km/h)','Pressure (millibars)','Wind Bearing (degrees)']]

target_temp = pd.DataFrame(df[['Temperature (C)']])

target_temp_scaled = scale.fit_transform(target_temp)

kf = KFold(n_splits=10, random_state=1234,shuffle=True)

for train_index, test_index in kf.split(feature_multiple):
    X_train = feature_multiple.values[train_index]
    X_train_scaled = scale.fit_transform(np.array(X_train))

    y_train = target_temp_scaled[train_index]

    X_test = feature_multiple.values[test_index]
    X_test_scaled = scale.fit_transform(np.array(X_test))

    y_test = target_temp_scaled[test_index]

    RF_reg.fit(X_train_scaled,y_train.ravel())

    y_pred = RF_reg.predict(X_test_scaled)
    y_pred_train = RF_reg.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))

# Problem 9 Corrected
# This is still just slightly off. Expected 5.8323, Actual 5.9098

df = pd.read_csv('weatherHistory.csv')
PE = []
PE_train = []
RF_reg = RandomForestRegressor(n_estimators=100,max_depth=50)
scale = StandardScaler()
 
feature_multiple = df[['Humidity','Wind Speed (km/h)','Pressure (millibars)','Wind Bearing (degrees)']]

target_temp = pd.DataFrame(df[['Temperature (C)']])

kf = KFold(n_splits=10, random_state=1234,shuffle=True)

for train_index, test_index in kf.split(feature_multiple):
    X_train = feature_multiple.values[train_index]
    X_train_scaled = scale.fit_transform(np.array(X_train))

    y_train = target_temp.values[train_index]

    X_test = feature_multiple.values[test_index]
    X_test_scaled = scale.fit_transform(np.array(X_test))

    y_test = target_temp.values[test_index]

    RF_reg.fit(X_train_scaled,y_train.ravel())

    y_pred = RF_reg.predict(X_test_scaled)
    y_pred_train = RF_reg.predict(X_train_scaled)

    PE_train.append(mean_squared_error(y_train,y_pred_train, squared=False))
    PE.append(mean_squared_error(y_test, y_pred, squared=False))

print('The k-fold crossvalidated error rate on the train sets is: ' + str(np.mean(PE_train)))
print('The k-fold crossvalidated error rate on the test sets is: ' + str(np.mean(PE)))
```
